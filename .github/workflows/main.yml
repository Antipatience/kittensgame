name: Deploy
on:
  push:
    branches: [ "master", "dev/*" ]
  pull_request:
    branches: [ "master", "dev/*" ]

  jobs:
    build:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v4

        - name: Yarn setup
          uses: DerYeger/yarn-setup-action@master
          with:
            node-version: 16
        
        - name: Install dependencies
          run: yarn
          
        - name: Lint
          run: yarn lint

        - name: Test
          run: yarn test

    deploy:
      runs-on: ubuntu-latest
      needs: build
      steps:
        - name: executing remote ssh commands using password
          uses: appleboy/ssh-action@v1.0.0
          with:
            username: ${{ secrets.USERNAME }}
            host: ${{ secrets.HOST }}
            script: /var/www/kittensgame.com/html/deploy.sh
        
        
